version: 2
jobs:
  build:
    docker:
      - image: circleci/node 
    working_directory: ~/rchain.cloud
    steps:
      - checkout
      - setup_remote_docker
      - run: 
          name: Install dependencies
          command: npm install
      # Build and publish to Docker Hub
      - run: |
          echo $DOCKER_USER
          echo $DOCKER_PASS
          docker login -u $DOCKER_USER -p $DOCKER_PASS
          docker build -f Dockerfile.backend . -t rchaincommunity/rchaincloudbackend:latest
          docker push rchaincommunity/rchaincloudbackend:latest