version: 2
jobs:
  backend:
    docker:
      - image: circleci/node
      
    working_directory: ~/rchain.cloud

    steps:
      - checkout
      - setup_remote_docker
      - run: 
          name: Install dependencies
          command: npm install
      - deploy:
          name: Publish to docker hub
          command: |
            docker login -u $DOCKER_HUB_USER_ID -p $DOCKER_HUB_PWD
            docker tag rchaincloudbackend $DOCKER_HUB_USER_ID/rchaincloudbackend:latest
            docker push $DOCKER_HUB_USER_ID/rchaincloudbackend:latest